# Классификатор Пользователей и Ботов (User vs Bot Classifier)

## Описание

Этот проект представляет собой Python-библиотеку для автоматической классификации аккаунтов в социальных сетях как
реальных пользователей или ботов. Для классификации используются методы машинного обучения, а сама библиотека построена
с использованием принципов объектно-ориентированного программирования (ООП) для лучшей организации и расширяемости кода.

**Цель:** Разработать инструмент, который может анализировать характеристики профиля и активности аккаунта и
предсказывать, является ли он ботом (метка `1`) или пользователем (метка `0`).

## Возможности

* Загрузка данных из CSV файла.
* Автоматическая предобработка данных:
    * Обработка пропущенных значений (числовых и категориальных).
    * Удаление дубликатов строк.
* Инженерия признаков (создание новых признаков, например, `profile_completeness`).
* Векторизация признаков:
    * Преобразование категориальных признаков в числовые (One-Hot Encoding).
    * Масштабирование числовых признаков (StandardScaler).
* Обучение нескольких моделей классификации:
    * Логистическая регрессия
    * Случайный лес (Random Forest)
    * Градиентный бустинг (Gradient Boosting)
* Оценка качества моделей с использованием метрик: Accuracy, Precision, Recall, F1-score, ROC AUC.
* Визуализация результатов:
    * ROC-кривые для сравнения моделей.
    * Важность признаков для древовидных моделей.
    * График результатов классификации на тестовой выборке.
* Предсказание для новых данных с использованием лучшей обученной модели.
* Структурированный вывод с интерпретацией результатов.

## Набор данных (Dataset)

Ожидается, что входной файл `bots_vs_users.csv` находится в корневой директории проекта.

* **Формат:** CSV.
* **Заголовок:** Предполагается, что первая строка файла содержит названия столбцов.
* **Целевая переменная:** Столбец с именем `target`, где `0` обозначает пользователя, а `1` - бота.
* **Пропущенные значения:** Значения 'Unknown' и пустые строки автоматически распознаются как пропущенные.

## Требования

* Python 3.7+
* pandas
* numpy
* scikit-learn
* matplotlib
* seaborn

## Использование

1. Убедитесь, что файл `bots_vs_users.csv` находится в той же директории, что и `main.py`.
2. Запустите главный скрипт из корневой директории проекта:
   ```bash
   python main.py
   ```
3. **Вывод:**
    * В консоль будут выведены логи процесса, результаты оценки моделей (метрики) и итоговые выводы с интерпретацией.
    * В папке `visualizations/` (будет создана автоматически) сохранятся графики:
        * `roc_curves.png`: ROC-кривые для сравнения моделей.
        * `feature_importances_МОДЕЛЬ.png`: Графики важности признаков для моделей Random Forest и Gradient Boosting.
        * `classification_results_МОДЕЛЬ.png`: Визуализация точности классификации на тестовых данных по двум признакам.

## Обзор рабочего процесса (`main.py`)

1. **Загрузка данных:** Данные загружаются из CSV с помощью `DataLoader`.
2. **Инженерия признаков:** Добавляется признак `profile_completeness` с помощью `FeatureEngineer`.
3. **Разделение данных:** Данные делятся на обучающую и тестовую выборки (`train_test_split`).
4. **Предобработка и Векторизация:** Создается `FeatureVectorizer`, который настраивается (`fit`) *только* на обучающих
   данных (`X_train`). Он включает шаги импутации, масштабирования и кодирования.
5. **Обучение моделей:** `ModelTrainer` создает `Pipeline` для каждой модели. Пайплайн сначала применяет настроенный
   препроцессор (из `FeatureVectorizer`), а затем обучает классификатор на преобразованных данных.
6. **Оценка моделей:** `ModelEvaluator` использует обученные пайплайны для предсказания на тестовых данных (`X_test`),
   рассчитывает метрики и генерирует отчеты.
7. **Визуализация:** `ModelEvaluator` строит и сохраняет графики ROC-кривых, важности признаков и результатов
   классификации.
8. **Выводы:** Результаты интерпретируются, определяется лучшая модель, и демонстрируется пример предсказания.

## Описание Модулей

* **`DataLoader`:** Отвечает за загрузку данных из источника (CSV).
* **`DataCleaner`:** Выполняет базовую очистку (дубликаты, идентификация типов). *Примечание: импутация пропусков
  интегрирована в `FeatureVectorizer`.*
* **`FeatureEngineer`:** Создает новые признаки на основе существующих.
* **`FeatureVectorizer`:** Преобразует данные в числовой формат, готовый для моделей, используя `ColumnTransformer` и
  `Pipeline` для импутации, масштабирования и кодирования.
* **`ModelTrainer`:** Инкапсулирует логику обучения различных моделей классификации внутри `Pipeline`.
* **`ModelEvaluator`:** Отвечает за оценку производительности моделей и создание соответствующих визуализаций.